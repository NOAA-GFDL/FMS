<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>FMS: annual_mean_solar Interface Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">FMS
   &#160;<span id="projectnumber">2022.02.0</span>
   </div>
   <div id="projectbrief">Flexible Modeling System</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('interfaceastronomy__mod_1_1annual__mean__solar.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="interfaceastronomy__mod_1_1annual__mean__solar-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">annual_mean_solar Interface Reference<div class="ingroups"><a class="el" href="group__astronomy.html">Astronomy</a> &raquo; <a class="el" href="group__astronomy__mod.html">astronomy_mod</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Calculates the annual mean of solar information for a given latitude and time.  
 <a href="interfaceastronomy__mod_1_1annual__mean__solar.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a841f269b79251fd44b9fbe2a6c9af03f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceastronomy__mod_1_1annual__mean__solar.html#a841f269b79251fd44b9fbe2a6c9af03f">annual_mean_solar_2d</a> (js, je, lat, cosz, solar, fracday, rrsun)</td></tr>
<tr class="memdesc:a841f269b79251fd44b9fbe2a6c9af03f"><td class="mdescLeft">&#160;</td><td class="mdescRight">annual_mean_solar_2d returns 2d fields of annual mean values of the cosine of zenith angle, daylight fraction and earth-sun distance at the specified latitude.  <a href="interfaceastronomy__mod_1_1annual__mean__solar.html#a841f269b79251fd44b9fbe2a6c9af03f">More...</a><br /></td></tr>
<tr class="separator:a841f269b79251fd44b9fbe2a6c9af03f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73b22023f95ab51738595290b16fc913"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceastronomy__mod_1_1annual__mean__solar.html#a73b22023f95ab51738595290b16fc913">annual_mean_solar_1d</a> (jst, jnd, lat, cosz, solar, fracday, rrsun_out)</td></tr>
<tr class="memdesc:a73b22023f95ab51738595290b16fc913"><td class="mdescLeft">&#160;</td><td class="mdescRight">annual_mean_solar_1d creates 2-d input fields from 1-d input fields and then calls annual_mean_solar_2d to obtain 2-d output fields which are then stored into 1-d fields for return to the calling subroutine.  <a href="interfaceastronomy__mod_1_1annual__mean__solar.html#a73b22023f95ab51738595290b16fc913">More...</a><br /></td></tr>
<tr class="separator:a73b22023f95ab51738595290b16fc913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa834f1a14b5d706c6e18771a37ad0255"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceastronomy__mod_1_1annual__mean__solar.html#aa834f1a14b5d706c6e18771a37ad0255">annual_mean_solar_2level</a> (lat, cosz, solar)</td></tr>
<tr class="memdesc:aa834f1a14b5d706c6e18771a37ad0255"><td class="mdescLeft">&#160;</td><td class="mdescRight">annual_mean_solar_2level creates 2-d input fields from 1-d input fields and then calls annual_mean_solar_2d to obtain 2-d output fields which are then stored into 1-d fields for return to the calling subroutine. This subroutine will be called during model initialization.  <a href="interfaceastronomy__mod_1_1annual__mean__solar.html#aa834f1a14b5d706c6e18771a37ad0255">More...</a><br /></td></tr>
<tr class="separator:aa834f1a14b5d706c6e18771a37ad0255"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Calculates the annual mean of solar information for a given latitude and time. </p>
<div class="fragment"><div class="line"><span class="keyword">call </span>annual_mean_solar (js, je, lat, cosz, solar, fracday, rrsun)</div>
<div class="line"><span class="keyword">call </span>annual_mean_solar (lat, cosz, solar)</div>
</div><!-- fragment --><p>The second interface above is used by the spectral 2-layer model, which requires only cosz and solar as output arguments, and which makes this call during the initialization phase of the model. Separate routines exist within this interface for 1D or 2D input and output fields:</p>
<div class="fragment"><div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:,:)</span> :: lat</div>
<div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(in)</span>, <span class="keywordtype">dimension(:)</span>   :: lat</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:,:)</span> :: cosz, solar, fracday</div>
<div class="line"><span class="keywordtype">real</span>, <span class="keywordtype">intent(out)</span>, <span class="keywordtype">dimension(:)</span>   :: cosz, solar, fracday</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;jst&gt;</td><td>Starting subdomain j indices of data in the physics wiondow being integrated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;jnd&gt;</td><td>Ending subdomain j indices of data in the physics wiondow being integrated </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points [radians] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>cosz is the average over the year of the cosine of an effective zenith angle that would produce the correct daily solar flux if the sun were fixed at that single position for the period of daylight on the given day. in this average, the daily mean effective cosz is weighted by the daily mean solar flux. [dimensionless] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;solar&gt;</td><td>Normalized solar flux, averaged over the year, equal to the product of fracday*cosz*rrsun [dimensionless] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction calculated so as to make the average flux (solar) equal to the product of the flux-weighted avg cosz * this fracday * assumed annual mean avg Earth-Sun distance of 1.0. [dimensionless] </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>Annual mean Earth-Sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 [dimensionless] </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l00246">246</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>
</div><h2 class="groupheader">Member Function/Subroutine Documentation</h2>
<a id="a73b22023f95ab51738595290b16fc913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73b22023f95ab51738595290b16fc913">&#9670;&nbsp;</a></span>annual_mean_solar_1d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine annual_mean_solar_1d </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>jnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>solar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>annual_mean_solar_1d creates 2-d input fields from 1-d input fields and then calls annual_mean_solar_2d to obtain 2-d output fields which are then stored into 1-d fields for return to the calling subroutine. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;jst&gt;</td><td>Starting index of latitude window </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;jnd&gt;</td><td>Ending index of latitude window </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;solar&gt;</td><td>Shortwave flux factor: cosine of zenith angle * daylight fraction / (earth-sun distance squared) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun_out&gt;</td><td>Earth-Sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01857">1857</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="a841f269b79251fd44b9fbe2a6c9af03f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a841f269b79251fd44b9fbe2a6c9af03f">&#9670;&nbsp;</a></span>annual_mean_solar_2d()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine annual_mean_solar_2d </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>js</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>je</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>solar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>fracday</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>rrsun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>annual_mean_solar_2d returns 2d fields of annual mean values of the cosine of zenith angle, daylight fraction and earth-sun distance at the specified latitude. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;jst&gt;</td><td>Starting index of latitude window </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;jnd&gt;</td><td>Ending index of latitude window </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">&lt;lat&gt;</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;cosz&gt;</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;solar&gt;</td><td>Shortwave flux factor: cosine of zenith angle * daylight fraction / (earth-sun distance squared) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;fracday&gt;</td><td>Daylight fraction of time interval </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">&lt;rrsun&gt;</td><td>Earth-Sun distance (r) relative to semi-major axis of orbital ellipse (a):(a/r)**2 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01749">1749</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<a id="aa834f1a14b5d706c6e18771a37ad0255"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa834f1a14b5d706c6e18771a37ad0255">&#9670;&nbsp;</a></span>annual_mean_solar_2level()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine annual_mean_solar_2level </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>cosz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(out)&#160;</td>
          <td class="paramname"><em>solar</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>annual_mean_solar_2level creates 2-d input fields from 1-d input fields and then calls annual_mean_solar_2d to obtain 2-d output fields which are then stored into 1-d fields for return to the calling subroutine. This subroutine will be called during model initialization. </p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">FATAL,astronomy_mod annual_mean_solar_2level should be called only once</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">lat</td><td>Latitudes of model grid points </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">cosz</td><td>Cosine of solar zenith angle </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">solar</td><td>shortwave flux factor: cosine of zenith angle * daylight fraction / (earth-sun distance squared) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="astronomy_8F90_source.html#l01917">1917</a> of file <a class="el" href="astronomy_8F90_source.html">astronomy.F90</a>.</p>

</div>
</div>
<hr/>The documentation for this interface was generated from the following file:<ul>
<li>astronomy/<a class="el" href="astronomy_8F90_source.html">astronomy.F90</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>astronomy_mod</b></li><li class="navelem"><a class="el" href="interfaceastronomy__mod_1_1annual__mean__solar.html">annual_mean_solar</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
